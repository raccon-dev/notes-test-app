import React, { useState, useEffect } from 'react';

import { useDispatch } from 'react-redux'
import { notesHandler } from '../../../redux/actions/setNotes';



const Note = ({ id, date, noteBody, lastEdit, noteColor }) => {


    let textInput = null;
    useEffect(() => {
        textInput.focus();
    })

    const dispatch = useDispatch();

    const [readOnly, setReadOnly] = useState(true);
    const [notesText, setNotesText] = useState('');
    const [oldNoteText, setOldNoteText] = useState('');
    const typingHandler = (value) => {
        setNotesText(value)
    }


    const onEditHandler = () => {

        setReadOnly(!readOnly);
        setOldNoteText(notesText);
        if (!readOnly && oldNoteText !== notesText) {
            dispatch(notesHandler(id, 'PUT', {
                "notesBody": notesText
            }))
        }
    }
    const onDeleteHandler = () => {
        dispatch(notesHandler(id, 'DELETE'))
    }

    return (
        <li className="notes-item" style={{ backgroundColor: noteColor }}>
            <div className="notes-buttons-wrapper">

                <button onClick={e => onEditHandler()} className="btn-editNote">

                    {readOnly ? (
                        <svg className="pencil" style={{ backgroundColor: 'transparent' }} height="35" viewBox="0 0 512 512" width="35" xmlns="http://www.w3.org/2000/svg" data-name="Layer 1"><g id="_Path_" data-name=" Path "><path d="m74.44 373.02-14.79 50.27 27.71 27.71 1.35 1.35 50.27-14.79z" fill="#e1b7a3" /><path d="m88.71 452.35-41.18 12.12 12.12-41.18 27.71 27.71z" fill="#b0b5ca" /></g><path d="m80.289 295.863h340.012v25.173h-340.012z" fill="#ef96a9" transform="matrix(.707 -.707 .707 .707 -144.797 267.32)" /><path d="m56.919 264.616h340.012v40.927h-340.012z" fill="#eb7288" transform="matrix(.707 -.707 .707 .707 -135.116 243.951)" /><path d="m33.549 249.123h340.012v25.173h-340.012z" fill="#ef96a9" transform="matrix(.707 -.707 .707 .707 -125.436 220.581)" /><path d="m357.245 77.605-48.727 48.727 77.17 77.129 48.781-48.965z" fill="#d4e1f4" /><path d="m464.47 112.07-36.29 36.3h-.01l-64.53-64.54 36.29-36.3z" fill="#c0c5d9" /><path d="m308.429 97.825h68.907v28.284h-68.907z" fill="#bccee2" transform="matrix(.707 -.707 .707 .707 21.255 275.249)" /><path d="m366.121 61.538h51.329v28.284h-51.329z" fill="#a9afc4" transform="matrix(.707 -.707 .707 .707 61.268 299.246)" /><g fill="#284268"><path d="m47.532 470.468a5.961 5.961 0 0 0 1.693-.244l91.446-26.9 2.464-1.443c.027-.026.059-.044.086-.07l236.186-236.192 2.061 2.06a6 6 0 0 0 8.485 0l48.766-48.766a6 6 0 0 0 0-8.485l-2.06-2.061 32.052-32.052a6 6 0 0 0 0-8.485l-64.541-64.541a6 6 0 0 0 -8.485 0l-32.052 32.052-2.061-2.06a6 6 0 0 0 -8.485 0l-48.766 48.766a6 6 0 0 0 0 8.485l2.06 2.061-236.187 236.186c-.027.027-.044.059-.069.086l-1.444 2.464-26.9 91.446a6 6 0 0 0 5.756 7.693zm91.446-41.39-9.316-9.317 231.944-231.944 9.316 9.317zm-17.8-17.8-20.452-20.452 231.942-231.947 20.453 20.453zm278.749-355.261 56.056 56.056-27.809 27.809-56.056-56.056zm-42.6 29.992 68.661 68.661-40.278 40.281-68.661-68.661zm-42.464 55.069 9.317 9.316-231.941 231.944-9.317-9.316zm-237.523 243.333 50.249 50.249-37.152 10.931-24.027-24.028zm-14.789 50.264 14.774 14.774-20.932 6.158z" /><path d="m333.599 110.214h27.311v12h-27.311z" transform="matrix(.707 -.707 .707 .707 19.533 279.584)" /><path d="m349.986 126.601h27.311v12h-27.311z" transform="matrix(.707 -.707 .707 .707 12.745 295.971)" /><path d="m365.743 142.359h27.311v12h-27.311z" transform="matrix(.707 -.707 .707 .707 6.218 311.729)" /><path d="m382.131 158.746h27.311v12h-27.311z" transform="matrix(.707 -.707 .707 .707 -.57 328.116)" /></g></svg>
                    )
                        :
                        (

                            <svg className="done-icon" height="512pt" viewBox="0 0 512 512" width="512pt" xmlns="http://www.w3.org/2000/svg"><path d="m423.992188 7.5h-335.984376c-44.464843 0-80.507812 36.042969-80.507812 80.507812v335.984376c0 44.460937 36.042969 80.507812 80.507812 80.507812h335.984376c44.464843 0 80.507812-36.042969 80.507812-80.507812v-335.984376c0-44.464843-36.042969-80.507812-80.507812-80.507812zm0 0" fill="#b2e59c" /><path d="m285.613281 7.5h-197.605469c-44.460937 0-80.507812 36.042969-80.507812 80.507812v335.984376c0 44.460937 36.046875 80.507812 80.507812 80.507812h103.667969c-81.597656-97.851562-50.875-278.679688 10.753907-349.222656 59.511718-68.113282 77.679687-122.640625 83.183593-147.777344zm0 0" fill="#9ad880" /><path d="m234.132812 378.574219c-10.207031 0-20.054687-3.902344-27.496093-10.949219l-104.738281-99.148438c-16.042969-15.1875-16.734376-40.503906-1.546876-56.546874 15.1875-16.039063 40.5-16.738282 56.546876-1.550782l74.929687 70.933594 121.027344-134.628906c14.769531-16.429688 40.058593-17.773438 56.488281-3.007813 16.429688 14.769531 17.773438 40.058594 3.003906 56.488281l-148.464844 165.152344c-7.214843 8.023438-17.359374 12.792969-28.140624 13.226563-.535157.023437-1.074219.03125-1.609376.03125zm0 0" fill="#fff" /><path d="m156.898438 210.382812c-16.046876-15.191406-41.363282-14.492187-56.550782 1.546876-15.1875 16.046874-14.492187 41.359374 1.550782 56.550781l42.46875 40.199219c3.464843-31.980469 11.027343-62.828126 21.515624-89.789063zm0 0" fill="#ccf8ff" /><path d="m504.5 379.007812c4.144531 0 7.5-3.355468 7.5-7.5v-283.5c0-48.527343-39.480469-88.007812-88.007812-88.007812h-335.984376c-48.527343 0-88.007812 39.480469-88.007812 88.007812v335.984376c0 48.527343 39.480469 88.007812 88.007812 88.007812h335.984376c48.527343 0 88.007812-39.480469 88.007812-88.007812v-20.511719c0-4.144531-3.355469-7.5-7.5-7.5s-7.5 3.355469-7.5 7.5v20.511719c0 40.257812-32.75 73.007812-73.007812 73.007812h-335.984376c-40.257812 0-73.007812-32.75-73.007812-73.007812v-335.984376c0-40.257812 32.75-73.007812 73.007812-73.007812h335.984376c40.257812 0 73.007812 32.75 73.007812 73.007812v283.5c0 4.144532 3.355469 7.5 7.5 7.5zm0 0" /><path d="m151.742188 215.828125 21.09375 19.96875c3.007812 2.851563 7.757812 2.71875 10.605468-.289063 2.847656-3.007812 2.714844-7.753906-.292968-10.601562l-21.09375-19.972656c-19.023438-18.003906-49.144532-17.175782-67.152344 1.84375-18.003906 19.019531-17.179688 49.144531 1.839844 67.148437l104.738281 99.144531c8.859375 8.386719 20.195312 12.96875 34.566406 12.96875 12.730469 0 24.898437-6.238281 33.410156-15.707031l148.46875-165.152343c17.511719-19.480469 15.910157-49.570313-3.566406-67.082032-19.480469-17.507812-49.574219-15.90625-67.082031 3.570313l-115.882813 128.90625-24.636719-23.320313c-3.011718-2.851562-7.757812-2.71875-10.605468.289063-2.847656 3.007812-2.714844 7.753906.292968 10.601562l30.226563 28.613281c2.871094 2.542969 7.351563 3.078126 10.730469-.433593l121.027344-134.628907c11.980468-13.324218 32.570312-14.421874 45.898437-2.441406 13.328125 11.980469 14.421875 32.570313 2.441406 45.898438l-148.464843 165.152344c-5.824219 6.476562-14.15625 10.394531-22.859376 10.746093-8.800781.351563-17.273437-2.832031-23.652343-8.871093l-104.734375-99.148438c-13.015625-12.320312-13.578125-32.929688-1.261719-45.945312 12.320313-13.011719 32.929687-13.578126 45.945313-1.257813zm0 0" /></svg>

                        )}


                </button>
                <button onClick={e => onDeleteHandler()} className="btn-removeNotes">
                    <svg className="remove-icon" enableBackground="new 0 0 512 512" height="512" viewBox="0 0 512 512" width="512" xmlns="http://www.w3.org/2000/svg"><g><g><path d="m415.158 85.758c-.268.087-93.932 27.686-94.198 27.777-10.041 3.493-16.788 12.983-16.788 23.614v42.223c0 8.285 6.716 15.001 15.001 15.001h114.008c8.285 0 15.001-6.716 15.001-15.001v-69.935c0-17.077-16.817-29.172-33.024-23.679z" fill="#ff5e94" /><path d="m160.161 164.371v282.624c0 35.844 29.161 65.005 65.005 65.005h158.012c35.844 0 65.005-29.161 65.005-65.005 0-15.734 0-274.731 0-282.624z" fill="#9dcfff" /><path d="m304.172 164.371v347.629h79.006c35.843 0 65.005-29.162 65.005-65.005v-282.624z" fill="#72bbff" /><g fill="#5a5a5a"><path d="m237.431 233.376c-8.285 0-15.001 6.716-15.001 15.001v179.616c0 8.285 6.716 15.001 15.001 15.001s15.001-6.716 15.001-15.001v-179.616c0-8.285-6.717-15.001-15.001-15.001z" /><path d="m304.171 233.376c-8.285 0-15.001 6.716-15.001 15.001v179.616c0 8.285 6.716 15.001 15.001 15.001s15.001-6.716 15.001-15.001v-179.616c0-8.285-6.716-15.001-15.001-15.001z" /></g><g fill="#444"><path d="m319.172 248.381v179.613c0 8.281-6.72 15.001-15.001 15.001v-209.615c8.281 0 15.001 6.71 15.001 15.001z" /><path d="m370.912 233.376c-8.285 0-15.001 6.716-15.001 15.001v179.616c0 8.285 6.716 15.001 15.001 15.001s15.001-6.716 15.001-15.001v-179.616c0-8.285-6.716-15.001-15.001-15.001z" /></g><path d="m192.17 18.07s0 0-.01 0c-15.336-9.588-36.016-7.793-49.46 5.65v.01l-27.58 27.57-27.58 27.58c-15.6 15.6-15.6 40.98 0 56.57l14.15 14.15 20.31-2.1.9-19.12-14.14-14.14c-3.9-3.9-3.9-10.25 0-14.14l27.58-27.58 27.57-27.58h.01c3.689-3.689 10.025-4.116 14.13-.01l14.15 14.15 18.55-3.08 2.67-18.13c-14.806-14.806-16.41-16.818-21.25-19.8z" fill="#5a5a5a" /><path d="m192.17 18.07s0 0-.01 0c-15.297-9.564-35.968-7.831-49.46 5.66l-27.58 27.57 21.22 21.22 27.58-27.58c3.686-3.686 10.017-4.124 14.13-.01l14.15 14.15 21.22-21.21c-15.291-15.291-16.162-16.574-21.25-19.8z" fill="#444" /><path d="m317.418 37.108-26.872-26.872c-13.647-13.647-35.853-13.647-49.501 0l-166.992 166.991c-13.647 13.647-13.647 35.853 0 49.501l26.872 26.872c5.857 5.858 15.356 5.859 21.214 0l195.279-195.278c5.858-5.858 5.858-15.356 0-21.214z" fill="#3ba9ff" /><path d="m290.545 10.236 26.872 26.872c5.855 5.855 5.862 15.352 0 21.215l-97.637 97.637-62.23-62.23 83.494-83.494c13.648-13.648 35.853-13.648 49.501 0z" fill="#0081ff" /></g></g></svg>
                </button>
            </div>
            <textarea ref={(button) => { textInput = button; }} readOnly={readOnly} defaultValue={noteBody} onChange={e => typingHandler(e.target.value)} className="notes-body notes-edit-section" name="" id="" cols="25"
                rows="7" />
            <div className="notes-footer">
                <p className="date"> <span className="edited-props">{lastEdit === true ? 'last edited' : 'Created'}</span> {date}</p>

            </div>
        </li >
    );
}

export default Note;
